<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [rain-sdk](./rain-sdk.md) &gt; [Sale](./rain-sdk.sale.md)

## Sale class

A class for deploying and calling methods on a Sale.

<b>Signature:</b>

```typescript
export declare class Sale extends FactoryContract 
```
<b>Extends:</b> [FactoryContract](./rain-sdk.factorycontract.md)

## Remarks

This class provides an easy way to deploy Sales using Rain's canonical factories, and methods for interacting with an already deployed Sale.

## Example


```typescript
import { Sale } from 'rain-sdk'
// To deploy a new Sale, pass an ethers.js Signer and the config for the Sale.
const newSale = await Sale.deploy(signer, SaleArgs)

// To connect to an existing Sale just pass the address and an ethers.js Signer.
const existingSale = new Sale(address, signer)

// Once you have a Sale, you can call the smart contract methods:
await existingSale.start()
await existingSale.buy(config_)
```

## Constructors

|  Constructor | Modifiers | Description |
|  --- | --- | --- |
|  [(constructor)(address, signer)](./rain-sdk.sale._constructor_.md) |  | Constructs a new Sale from a known address. |

## Properties

|  Property | Modifiers | Type | Description |
|  --- | --- | --- | --- |
|  [buy](./rain-sdk.sale.buy.md) |  | (config: [BuyConfig](./rain-sdk.buyconfig.md)<!-- -->, overrides?: [TxOverrides](./rain-sdk.txoverrides.md)<!-- -->) =&gt; Promise&lt;ContractTransaction&gt; | Main entrypoint to the sale. Sells rTKN in exchange for reserve token. The price curve is eval'd to produce a reserve price quote. Each 1 unit of rTKN costs <code>price</code> reserve token where BOTH the rTKN units and price are treated as 18 decimal fixed point values. If the reserve token has more or less precision by its own conventions (e.g. "decimals" method on ERC20 tokens) then the price will need to scale accordingly. The receipt is \_logged\_ rather than returned as it cannot be used in same block for a refund anyway due to cooldowns. |
|  [calculatePrice](./rain-sdk.sale.calculateprice.md) |  | (units: BigNumberish, overrides?: [ReadTxOverrides](./rain-sdk.readtxoverrides.md)<!-- -->) =&gt; Promise&lt;BigNumber&gt; | Calculates the current reserve price quoted for 1 unit of rTKN. Used internally to process <code>buy</code> |
|  [canEnd](./rain-sdk.sale.canend.md) |  | (overrides?: [ReadTxOverrides](./rain-sdk.readtxoverrides.md)<!-- -->) =&gt; Promise&lt;boolean&gt; | Can the sale end? Evals <code>canEndStatePointer</code> to a boolean that determines whether the sale can end (move from active to success/fail). Buying will fail if the sale has ended. If the sale is out of rTKN stock it can ALWAYS end and in this case will NOT eval the "can end" script. The sale can ONLY end if it is currently in active status. |
|  [canStart](./rain-sdk.sale.canstart.md) |  | (overrides?: [ReadTxOverrides](./rain-sdk.readtxoverrides.md)<!-- -->) =&gt; Promise&lt;boolean&gt; | Can the sale start? Evals <code>canStartStatePointer</code> to a boolean that determines whether the sale can start (move from pending to active). Buying from and ending the sale will both always fail if the sale never started. The sale can ONLY start if it is currently in pending status. |
|  [claimFees](./rain-sdk.sale.claimfees.md) |  | (recipient: string, overrides?: [TxOverrides](./rain-sdk.txoverrides.md)<!-- -->) =&gt; Promise&lt;ContractTransaction&gt; | After a sale ends in success all fees collected for a recipient can be cleared. If the raise is active or fails then fees cannot be claimed as they are set aside in case of refund. A failed raise implies that all buyers should immediately refund and zero fees claimed. |
|  [concat](./rain-sdk.sale.concat.md) | <code>static</code> | typeof utils.concat |  |
|  [connect](./rain-sdk.sale.connect.md) |  | (signer: Signer) =&gt; [Sale](./rain-sdk.sale.md) |  |
|  [deploy](./rain-sdk.sale.deploy.md) | <code>static</code> | (signer: Signer, saleConfig: [SaleConfig](./rain-sdk.saleconfig.md)<!-- -->, saleRedeemableERC20Config: [SaleRedeemableERC20Config](./rain-sdk.saleredeemableerc20config.md)<!-- -->, overrides?: [TxOverrides](./rain-sdk.txoverrides.md)<!-- -->) =&gt; Promise&lt;[Sale](./rain-sdk.sale.md)<!-- -->&gt; | Deploys a new Sale. |
|  [end](./rain-sdk.sale.end.md) |  | (overrides?: [TxOverrides](./rain-sdk.txoverrides.md)<!-- -->) =&gt; Promise&lt;ContractTransaction&gt; | End the sale (move from active to success or fail). - <code>canEnd</code> MUST return true. |
|  [getRedeemable](./rain-sdk.sale.getredeemable.md) |  | (signer?: Signer) =&gt; Promise&lt;[RedeemableERC20](./rain-sdk.redeemableerc20.md)<!-- -->&gt; | Obtain the instance redeemable token from this sale. |
|  [isChild](./rain-sdk.sale.ischild.md) | <code>static</code> | (signer: Signer, maybeChild: string) =&gt; Promise&lt;boolean&gt; | Checks if address is registered as a child contract of this SaleFactory on a specific network |
|  [nameBookReference](./rain-sdk.sale.namebookreference.md) | <code>static</code> | (not declared) |  |
|  [op](./rain-sdk.sale.op.md) | <code>static</code> | (code: number, erand?: number \| utils.BytesLike \| utils.Hexable) =&gt; Uint8Array |  |
|  [Opcodes](./rain-sdk.sale.opcodes.md) | <code>static</code> | { REMAINING\_UNITS: number; TOTAL\_RESERVE\_IN: number; CURRENT\_BUY\_UNITS: number; TOKEN\_ADDRESS: number; RESERVE\_ADDRESS: number; SKIP: import("../classes/vm").[AllStandardOps.SKIP](./rain-sdk.allstandardops.md)<!-- -->; VAL: import("../classes/vm").[AllStandardOps.VAL](./rain-sdk.allstandardops.md)<!-- -->; DUP: import("../classes/vm").[AllStandardOps.DUP](./rain-sdk.allstandardops.md)<!-- -->; ZIPMAP: import("../classes/vm").[AllStandardOps.ZIPMAP](./rain-sdk.allstandardops.md)<!-- -->; DEBUG: import("../classes/vm").[AllStandardOps.DEBUG](./rain-sdk.allstandardops.md)<!-- -->; BLOCK\_NUMBER: import("../classes/vm").[AllStandardOps.BLOCK\_NUMBER](./rain-sdk.allstandardops.md)<!-- -->; BLOCK\_TIMESTAMP: import("../classes/vm").[AllStandardOps.BLOCK\_TIMESTAMP](./rain-sdk.allstandardops.md)<!-- -->; SENDER: import("../classes/vm").[AllStandardOps.SENDER](./rain-sdk.allstandardops.md)<!-- -->; THIS\_ADDRESS: import("../classes/vm").[AllStandardOps.THIS\_ADDRESS](./rain-sdk.allstandardops.md)<!-- -->; SCALE18\_MUL: import("../classes/vm").[AllStandardOps.SCALE18\_MUL](./rain-sdk.allstandardops.md)<!-- -->; SCALE18\_DIV: import("../classes/vm").[AllStandardOps.SCALE18\_DIV](./rain-sdk.allstandardops.md)<!-- -->; SCALE18: import("../classes/vm").[AllStandardOps.SCALE18](./rain-sdk.allstandardops.md)<!-- -->; SCALEN: import("../classes/vm").[AllStandardOps.SCALEN](./rain-sdk.allstandardops.md)<!-- -->; SCALE\_BY: import("../classes/vm").[AllStandardOps.SCALE\_BY](./rain-sdk.allstandardops.md)<!-- -->; SCALE18\_ONE: import("../classes/vm").[AllStandardOps.SCALE18\_ONE](./rain-sdk.allstandardops.md)<!-- -->; SCALE18\_DECIMALS: import("../classes/vm").[AllStandardOps.SCALE18\_DECIMALS](./rain-sdk.allstandardops.md)<!-- -->; ADD: import("../classes/vm").[AllStandardOps.ADD](./rain-sdk.allstandardops.md)<!-- -->; SATURATING\_ADD: import("../classes/vm").[AllStandardOps.SATURATING\_ADD](./rain-sdk.allstandardops.md)<!-- -->; SUB: import("../classes/vm").[AllStandardOps.SUB](./rain-sdk.allstandardops.md)<!-- -->; SATURATING\_SUB: import("../classes/vm").[AllStandardOps.SATURATING\_SUB](./rain-sdk.allstandardops.md)<!-- -->; MUL: import("../classes/vm").[AllStandardOps.MUL](./rain-sdk.allstandardops.md)<!-- -->; SATURATING\_MUL: import("../classes/vm").[AllStandardOps.SATURATING\_MUL](./rain-sdk.allstandardops.md)<!-- -->; DIV: import("../classes/vm").[AllStandardOps.DIV](./rain-sdk.allstandardops.md)<!-- -->; MOD: import("../classes/vm").[AllStandardOps.MOD](./rain-sdk.allstandardops.md)<!-- -->; EXP: import("../classes/vm").[AllStandardOps.EXP](./rain-sdk.allstandardops.md)<!-- -->; MIN: import("../classes/vm").[AllStandardOps.MIN](./rain-sdk.allstandardops.md)<!-- -->; MAX: import("../classes/vm").[AllStandardOps.MAX](./rain-sdk.allstandardops.md)<!-- -->; ISZERO: import("../classes/vm").[AllStandardOps.ISZERO](./rain-sdk.allstandardops.md)<!-- -->; EAGER\_IF: import("../classes/vm").[AllStandardOps.EAGER\_IF](./rain-sdk.allstandardops.md)<!-- -->; EQUAL\_TO: import("../classes/vm").[AllStandardOps.EQUAL\_TO](./rain-sdk.allstandardops.md)<!-- -->; LESS\_THAN: import("../classes/vm").[AllStandardOps.LESS\_THAN](./rain-sdk.allstandardops.md)<!-- -->; GREATER\_THAN: import("../classes/vm").[AllStandardOps.GREATER\_THAN](./rain-sdk.allstandardops.md)<!-- -->; EVERY: import("../classes/vm").[AllStandardOps.EVERY](./rain-sdk.allstandardops.md)<!-- -->; ANY: import("../classes/vm").[AllStandardOps.ANY](./rain-sdk.allstandardops.md)<!-- -->; REPORT: import("../classes/vm").[AllStandardOps.REPORT](./rain-sdk.allstandardops.md)<!-- -->; NEVER: import("../classes/vm").[AllStandardOps.NEVER](./rain-sdk.allstandardops.md)<!-- -->; ALWAYS: import("../classes/vm").[AllStandardOps.ALWAYS](./rain-sdk.allstandardops.md)<!-- -->; SATURATING\_DIFF: import("../classes/vm").[AllStandardOps.SATURATING\_DIFF](./rain-sdk.allstandardops.md)<!-- -->; UPDATE\_BLOCKS\_FOR\_TIER\_RANGE: import("../classes/vm").[AllStandardOps.UPDATE\_BLOCKS\_FOR\_TIER\_RANGE](./rain-sdk.allstandardops.md)<!-- -->; SELECT\_LTE: import("../classes/vm").[AllStandardOps.SELECT\_LTE](./rain-sdk.allstandardops.md)<!-- -->; IERC20\_BALANCE\_OF: import("../classes/vm").[AllStandardOps.IERC20\_BALANCE\_OF](./rain-sdk.allstandardops.md)<!-- -->; IERC20\_TOTAL\_SUPPLY: import("../classes/vm").[AllStandardOps.IERC20\_TOTAL\_SUPPLY](./rain-sdk.allstandardops.md)<!-- -->; IERC721\_BALANCE\_OF: import("../classes/vm").[AllStandardOps.IERC721\_BALANCE\_OF](./rain-sdk.allstandardops.md)<!-- -->; IERC721\_OWNER\_OF: import("../classes/vm").[AllStandardOps.IERC721\_OWNER\_OF](./rain-sdk.allstandardops.md)<!-- -->; IERC1155\_BALANCE\_OF: import("../classes/vm").[AllStandardOps.IERC1155\_BALANCE\_OF](./rain-sdk.allstandardops.md)<!-- -->; IERC1155\_BALANCE\_OF\_BATCH: import("../classes/vm").[AllStandardOps.IERC1155\_BALANCE\_OF\_BATCH](./rain-sdk.allstandardops.md)<!-- -->; length: import("../classes/vm").[AllStandardOps.length](./rain-sdk.allstandardops.md)<!-- -->; } |  |
|  [refund](./rain-sdk.sale.refund.md) |  | (receipt: [Receipt](./rain-sdk.receipt.md)<!-- -->, overrides?: [TxOverrides](./rain-sdk.txoverrides.md)<!-- -->) =&gt; Promise&lt;ContractTransaction&gt; | Rollback a buy given its receipt. Ignoring gas (which cannot be refunded) the refund process rolls back all state changes caused by a buy, other than the receipt id increment. Refunds are limited by the global cooldown to mitigate rapid buy/refund cycling that could cause volatile price curves or other unwanted side effects for other sale participants. Cooldowns are bypassed if the sale ends and is a failure. |
|  [reserve](./rain-sdk.sale.reserve.md) |  | (overrides?: [ReadTxOverrides](./rain-sdk.readtxoverrides.md)<!-- -->) =&gt; Promise&lt;string&gt; | Returns the address of the token that sale prices are denominated in. MUST NOT change during the lifecycle of the sale contract. |
|  [saleStatus](./rain-sdk.sale.salestatus.md) |  | (overrides?: [ReadTxOverrides](./rain-sdk.readtxoverrides.md)<!-- -->) =&gt; Promise&lt;number&gt; | Returns the current <code>SaleStatus</code> of the sale. Represents a linear progression of the sale through its major lifecycle events. |
|  [start](./rain-sdk.sale.start.md) |  | (overrides?: [TxOverrides](./rain-sdk.txoverrides.md)<!-- -->) =&gt; Promise&lt;ContractTransaction&gt; | Start the sale (move from pending to active). - <code>canStart</code> MUST return true. |
|  [timeout](./rain-sdk.sale.timeout.md) |  | (overrides?: [TxOverrides](./rain-sdk.txoverrides.md)<!-- -->) =&gt; Promise&lt;ContractTransaction&gt; | Timeout the sale (move from pending or active to fail). The ONLY condition for a timeout is that the <code>saleTimeout</code> block set during initialize is in the past. This means that regardless of what happens re: starting, ending, buying, etc. if the sale does NOT manage to unambiguously end by the timeout block then it can timeout to a fail state. This means that any downstream escrows or similar can always expect that eventually they will see a pass/fail state and so are safe to lock funds while a Sale is active. |
|  [token](./rain-sdk.sale.token.md) |  | (overrides?: [ReadTxOverrides](./rain-sdk.readtxoverrides.md)<!-- -->) =&gt; Promise&lt;string&gt; | Returns the address of the token being sold in the sale. MUST NOT change during the lifecycle of the sale contract. |

## Methods

|  Method | Modifiers | Description |
|  --- | --- | --- |
|  [afterBlockNumberConfig(blockNumber)](./rain-sdk.sale.afterblocknumberconfig.md) | <code>static</code> | Create a condition as VM state configuration to that is true after a <code>blockNumber</code> in the chain. |
|  [afterTimestampConfig(timestamp)](./rain-sdk.sale.aftertimestampconfig.md) | <code>static</code> | Create a condition as VM state configuration to that is true after a <code>timestamp</code> in the chain. |

